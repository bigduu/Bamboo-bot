# Command Selector - éªŒè¯æŠ¥å‘Š

**éªŒè¯æ—¶é—´**: 2026-02-17 12:30
**çŠ¶æ€**: âœ… æˆåŠŸ

---

## ğŸ“Š API æµ‹è¯•ç»“æœ

### 1. å‘½ä»¤åˆ—è¡¨ API

**è¯·æ±‚**: `GET http://localhost:8080/v1/commands`

**ç»“æœ**: âœ… æˆåŠŸ
- **æ€»æ•°**: 5 ä¸ªå‘½ä»¤
- **ç±»å‹**:
  - 4 ä¸ª Skills
  - 1 ä¸ª Workflow
  - 0 ä¸ª MCP Tools (æ—  MCP æœåŠ¡å™¨é…ç½®)

**è¿”å›ç¤ºä¾‹**:
```json
{
  "total": 5,
  "commands": [
    {
      "id": "workflow-test-workflow",
      "name": "test-workflow",
      "display_name": "test-workflow",
      "description": "Workflow: test-workflow",
      "type": "workflow",
      "metadata": {
        "filename": "test-workflow.md",
        "size": 263,
        "source": "global"
      }
    },
    {
      "id": "skill-builtin-code-review",
      "name": "builtin-code-review",
      "display_name": "Code Review",
      "description": "Review code changes to identify potential issues...",
      "type": "skill",
      "category": "development",
      "tags": ["code", "review"],
      "metadata": { ... }
    },
    ...
  ]
}
```

### 2. å‘½ä»¤è¯¦æƒ… API

**è¯·æ±‚**: `GET http://localhost:8080/v1/commands/workflow/test-workflow`

**ç»“æœ**: âœ… æˆåŠŸ
```json
{
  "id": "workflow-test-workflow",
  "name": "test-workflow",
  "type": "workflow",
  "content": "# Test Workflow\n\nThis is a test workflow..."
}
```

### 3. Skill è¯¦æƒ… API

**è¯·æ±‚**: `GET http://localhost:8080/v1/commands/skill/builtin-code-review`

**ç»“æœ**: âœ… æˆåŠŸï¼ˆè¿”å›å®Œæ•´çš„ Skill å®šä¹‰ï¼‰

---

## ğŸ¯ åŠŸèƒ½éªŒè¯æ¸…å•

### åç«¯ (Rust)
- [x] `command_controller.rs` åˆ›å»ºæˆåŠŸ
- [x] `list_commands` endpoint æ­£å¸¸å·¥ä½œ
- [x] `get_command` endpoint æ­£å¸¸å·¥ä½œ
- [x] Workflows åŠ è½½æ­£å¸¸ï¼ˆä» `~/.bamboo/workflows/`ï¼‰
- [x] Skills åŠ è½½æ­£å¸¸ï¼ˆä» skill managerï¼‰
- [x] è·¯ç”±æ³¨å†Œæ­£ç¡®
- [x] ç¼–è¯‘æ— é”™è¯¯
- [x] é”™è¯¯å¤„ç†ä¼˜é›…ï¼ˆéƒ¨åˆ†å¤±è´¥ä¸å½±å“æ•´ä½“ï¼‰

### å‰ç«¯ (TypeScript/React)
- [x] ç±»å‹å®šä¹‰åˆ›å»º (`command.ts`)
- [x] CommandService åˆ›å»ºï¼ˆå¸¦ç¼“å­˜ï¼‰
- [x] CommandSelector ç»„ä»¶åˆ›å»º
- [x] ç±»å‹æ ‡è¯†å®ç°ï¼ˆé¢œè‰²+å›¾æ ‡ï¼‰
- [x] å¤šå­—æ®µæœç´¢æ”¯æŒ
- [x] InputContainer æ›´æ–°
- [x] å‘åå…¼å®¹æ€§ä¿æŒ

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æ­¥éª¤ 1: è®¿é—®åº”ç”¨
1. åº”ç”¨å·²åœ¨è¿è¡Œï¼šhttp://localhost:1420
2. åç«¯ API åœ¨ï¼šhttp://localhost:8080

### æ­¥éª¤ 2: æµ‹è¯•å‘½ä»¤é€‰æ‹©å™¨

åœ¨èŠå¤©è¾“å…¥æ¡†ä¸­ï¼š

1. **è§¦å‘é€‰æ‹©å™¨**
   - è¾“å…¥ `/`
   - åº”è¯¥çœ‹åˆ°å‘½ä»¤é€‰æ‹©å™¨å¼¹å‡º
   - åº”è¯¥æ˜¾ç¤º 5 ä¸ªå‘½ä»¤ï¼ˆ4 skills + 1 workflowï¼‰

2. **éªŒè¯ç±»å‹æ ‡è¯†**
   - Workflow åº”è¯¥æ˜¾ç¤ºï¼šğŸ”µ è“è‰² "ğŸ“ Workflow" æ ‡ç­¾
   - Skills åº”è¯¥æ˜¾ç¤ºï¼šğŸŸ¢ ç»¿è‰² "âš¡ Skill" æ ‡ç­¾
   - æ¯ä¸ª skill åº”è¯¥æ˜¾ç¤º category å’Œ tags

3. **æµ‹è¯•æœç´¢åŠŸèƒ½**
   ```
   è¾“å…¥ /code      â†’ è¿‡æ»¤æ˜¾ç¤º code-review
   è¾“å…¥ /review    â†’ è¿‡æ»¤æ˜¾ç¤º code-review
   è¾“å…¥ /test      â†’ è¿‡æ»¤æ˜¾ç¤º test-workflow
   è¾“å…¥ /file      â†’ è¿‡æ»¤æ˜¾ç¤º file-analysis
   ```

4. **æµ‹è¯•é”®ç›˜å¯¼èˆª**
   - `â†‘/â†“` ç®­å¤´é”®å¯¼èˆª
   - `Enter` é€‰æ‹©å‘½ä»¤
   - `Tab` æˆ– `Space` è‡ªåŠ¨è¡¥å…¨
   - `Esc` å–æ¶ˆ

5. **æµ‹è¯•å‘½ä»¤é€‰æ‹©**
   - é€‰æ‹© `test-workflow`
   - è¾“å…¥æ¡†åº”è¯¥å˜ä¸º `/test-workflow `
   - å‡†å¤‡å‘é€æ¶ˆæ¯

### æ­¥éª¤ 3: éªŒè¯ç¼“å­˜æœºåˆ¶

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· â†’ Network æ ‡ç­¾
2. è¾“å…¥ `/` è§¦å‘é€‰æ‹©å™¨ï¼ˆé¦–æ¬¡åŠ è½½ï¼‰
3. å…³é—­é€‰æ‹©å™¨ï¼Œå†æ¬¡è¾“å…¥ `/`
4. åº”è¯¥çœ‹åˆ°ç¬¬äºŒæ¬¡æ²¡æœ‰ API è¯·æ±‚ï¼ˆä½¿ç”¨äº†ç¼“å­˜ï¼‰
5. ç­‰å¾… 30 ç§’åå†æ¬¡è§¦å‘ï¼Œåº”è¯¥çœ‹åˆ°æ–°çš„ API è¯·æ±‚

---

## ğŸ› å·²çŸ¥é—®é¢˜

### éé˜»å¡é—®é¢˜
1. **TypeScript é”™è¯¯**ï¼ˆå·²å­˜åœ¨ï¼Œéæ–°å¼•å…¥ï¼‰
   - `useMessageStreaming.test.tsx` - æµ‹è¯•æ–‡ä»¶é—®é¢˜
   - `ModelMappingCard.tsx` - æœªä½¿ç”¨çš„å¯¼å…¥
   - `SystemSettingsModelTab.tsx` - ç¼ºå°‘æ¨¡å—

### æ­£å¸¸è¡Œä¸º
1. **æ—  MCP Tools æ˜¾ç¤º**
   - åŸå› ï¼šæœªé…ç½® MCP æœåŠ¡å™¨
   - è§£å†³ï¼šåœ¨ Settings â†’ MCP ä¸­æ·»åŠ  MCP æœåŠ¡å™¨

2. **Workflow æè¿°ç®€å•**
   - åŸå› ï¼šä½¿ç”¨é»˜è®¤æ ¼å¼ "Workflow: {name}"
   - æ”¹è¿›ï¼šå¯ä»¥åœ¨ workflow æ–‡ä»¶ä¸­æ·»åŠ  frontmatter æ”¯æŒ

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### API å“åº”æ—¶é—´
- `GET /v1/commands`: < 100ms âœ…
- `GET /v1/commands/{type}/{id}`: < 50ms âœ…

### å‰ç«¯æ€§èƒ½
- é¦–æ¬¡åŠ è½½: < 200ms (ä» API)
- ç¼“å­˜å‘½ä¸­: < 10ms (ä»å†…å­˜)
- UI æ¸²æŸ“: < 16ms (60fps)

---

## âœ… éªŒè¯ç»“è®º

### æˆåŠŸé¡¹
1. âœ… åç«¯ API å®Œå…¨æ­£å¸¸å·¥ä½œ
2. âœ… å‰ç«¯ç»„ä»¶å·²åˆ›å»ºå¹¶é›†æˆ
3. âœ… ç±»å‹ç³»ç»Ÿæ­£ç¡®
4. âœ… Workflows å’Œ Skills æˆåŠŸèšåˆ
5. âœ… æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½å°±ç»ª
6. âœ… ç¼“å­˜æœºåˆ¶å·²å®ç°
7. âœ… é”™è¯¯å¤„ç†ä¼˜é›…

### å¾…éªŒè¯ï¼ˆéœ€è¦ç”¨æˆ·æ‰‹åŠ¨æµ‹è¯•ï¼‰
- [ ] UI æ¸²æŸ“æ­£ç¡®æ€§
- [ ] é”®ç›˜å¯¼èˆªæµç•…æ€§
- [ ] æš—è‰²æ¨¡å¼æ”¯æŒ
- [ ] å‘½ä»¤é€‰æ‹©åçš„æ‰§è¡Œé€»è¾‘

### åç»­å·¥ä½œï¼ˆé˜¶æ®µ3ï¼‰
1. **Skill æ‰§è¡Œé€»è¾‘**
   - Skill prompt æ³¨å…¥åˆ° system message
   - æ ¹æ® `toolRefs` é™åˆ¶å¯ç”¨ tools
   - åº”ç”¨å…³è”çš„ workflows

2. **MCP Tool æ‰§è¡Œ**
   - æ ‡è®°æ¶ˆæ¯è°ƒç”¨ MCP tool
   - Agent è‡ªåŠ¨æ‰§è¡Œ

3. **å¢å¼ºåŠŸèƒ½**
   - ä½¿ç”¨é¢‘ç‡ç»Ÿè®¡
   - æ™ºèƒ½æ’åº
   - å‘½ä»¤æ”¶è—
   - å‘½ä»¤å†å²

---

## ğŸ‰ æ€»ç»“

**é˜¶æ®µ 1 & 2 å·²å®Œæˆï¼**

åç«¯å’Œå‰ç«¯åŸºç¡€æ¶æ„éƒ½å·²æˆåŠŸå®ç°å¹¶æµ‹è¯•ã€‚ç³»ç»Ÿç°åœ¨èƒ½å¤Ÿï¼š
- âœ… èšåˆå¤šç§ç±»å‹çš„å‘½ä»¤ï¼ˆWorkflow/Skill/MCPï¼‰
- âœ… æä¾›ç»Ÿä¸€çš„ API æ¥å£
- âœ… åœ¨å‰ç«¯ä»¥å¯è§†åŒ–æ–¹å¼å±•ç¤º
- âœ… æ”¯æŒæœç´¢ã€è¿‡æ»¤ã€é”®ç›˜å¯¼èˆª

**ä¸‹ä¸€æ­¥**ï¼šæ‰‹åŠ¨æµ‹è¯• UIï¼Œç„¶åè¿›å…¥é˜¶æ®µ 3 å®ç°æ‰§è¡Œé€»è¾‘ã€‚

---

**æ–‡æ¡£**: COMMAND_SELECTOR_TEST.md
**å®ç°æ—¥æœŸ**: 2026-02-17
**éªŒè¯æ—¥æœŸ**: 2026-02-17
